package ca.ilanguage.aublog.ui;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;


import android.app.Activity;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.res.Configuration;
import android.database.Cursor;
import android.database.SQLException;
import android.graphics.Color;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.os.Handler;
import android.util.Log;
import android.view.KeyEvent;
import android.view.View;
import android.webkit.JsResult;
import android.webkit.WebChromeClient;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.Toast;

import ca.ilanguage.aublog.R;
import ca.ilanguage.aublog.db.AuBlogHistoryDatabase.AuBlogHistory;
import ca.ilanguage.aublog.db.AuBlogHistoryDatabase;
import ca.ilanguage.aublog.db.DBTextAdapter;
import ca.ilanguage.aublog.db.AuBlogHistoryProvider;
import ca.ilanguage.aublog.util.Alert;

/**
 * Demonstrates how to embed a WebView in your activity. Also demonstrates how
 * to have javascript in the WebView call into the activity, and how the activity 
 * can invoke javascript.
 * <p>
 * In this example, clicking on the android in the WebView will result in a call into
 * the activities code in {@link DemoJavaScriptInterface#clickOnAndroid()}. This code
 * will turn around and invoke javascript using the {@link WebView#loadUrl(String)}
 * method.
 * <p>
 * Obviously all of this could have been accomplished without calling into the activity
 * and then back into javascript, but this code is intended to show how to set up the 
 * code paths for this sort of communication.
 *
 */
public class ViewDraftTreeActivity extends Activity {

    private static final String TAG = "CreateBlogEntryActivity";

	//uri of the entry being edited.
	private Uri mUri;
	private Cursor mCursor;
	//savedInstanceState
	
	private static final int GROUP_BASIC = 0;
	private static final int GROUP_FORMAT = 1;
	int selectionStart;
	int selectionEnd;
	String mPostContent ="";
	String mPostTitle ="";
	String mPostLabels ="";
	private static final String[] PROJECTION = new String[] {
		AuBlogHistory.ENTRY_TITLE, 
		AuBlogHistory.ENTRY_CONTENT,
		AuBlogHistory.ENTRY_LABELS
	};
	
	private WebView mWebView;
    private Handler mHandler = new Handler();


    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main_webview);
        mWebView = (WebView) findViewById(R.id.webview);
        mWebView.addJavascriptInterface(new JavaScriptInterface(this), "Android");
        WebSettings webSettings = mWebView.getSettings();
        webSettings.setSavePassword(false);
        webSettings.setSaveFormData(false);
        webSettings.setJavaScriptEnabled(true);
        webSettings.setSupportZoom(true);
        webSettings.setBuiltInZoomControls(true);
        
        
		mWebView.loadUrl("file:///android_asset/view_draft_tree.html");
    }
    public class JavaScriptInterface {
        Context mContext;

        /** Instantiate the interface and set the context */
        JavaScriptInterface(Context c) {
            mContext = c;
            loadData();
        }
        public void showToast(String toast) {
            Toast.makeText(mContext, toast, Toast.LENGTH_SHORT).show();
        }
       
        public String loadData(){
//        	BufferedWriter mOut;
        	String mResultsFile="draft_tree_json.js";
//        	FileWriter fstream;
        	String path = Environment.getExternalStorageDirectory().getAbsolutePath() + "/Android/data/ca.ilanguage.aublog/files/";
        	String fname = mResultsFile;
            try {
                // Make sure the Pictures directory exists.
            	 boolean exists = (new File(path)).exists();  
                 if (!exists){ new File(path).mkdirs(); }
                 // Open output stream
                 FileOutputStream fOut = new FileOutputStream(path + fname);
//                fstream = new FileWriter(mResultsFile,true);
//        		mOut = new BufferedWriter(fstream);
            	String begining="var labelType, useGradients, nativeTextSupport, animate;\n\n(function() {\n  var ua = navigator.userAgent,\n      iStuff = ua.match(/iPhone/i) || ua.match(/iPad/i),\n      typeOfCanvas = typeof HTMLCanvasElement,\n      nativeCanvasSupport = (typeOfCanvas == 'object' || typeOfCanvas == 'function'),\n      textSupport = nativeCanvasSupport \n        && (typeof document.createElement('canvas').getContext('2d').fillText == 'function');\n  //I'm setting this based on the fact that ExCanvas provides text support for IE\n  //and that as of today iPhone/iPad current text support is lame\n  labelType = (!nativeCanvasSupport || (textSupport && !iStuff))? 'Native' : 'HTML';\n  nativeTextSupport = labelType == 'Native';\n  useGradients = nativeCanvasSupport;\n  animate = !(iStuff || !nativeCanvasSupport);\n})();\n\nvar Log = {\n  elem: false,\n  write: function(text){\n    if (!this.elem) \n      this.elem = document.getElementById('log');\n    this.elem.innerHTML = text;\n    this.elem.style.left = (200 - this.elem.offsetWidth / 2) + 'px';\n  }\n};\n\n\n\nfunction init(){\n    //init data\n";
            	String json = generateData();
            	String end="\n    //end\n    //init Spacetree\n    //Create a new ST instance\n    var st = new $jit.ST({\n    	orientation: "+'"'+"top"+'"'+",\n    	indent:10,\n        //id of viz container element\n        injectInto: 'infovis',\n        //set duration for the animation\n        duration: 800,\n        //set animation transition type\n        transition: $jit.Trans.Quart.easeInOut,\n        //set distance between node and its children\n        levelDistance: 50,\n        //enable panning\n        Navigation: {\n          enable:true,\n          panning:true\n        },\n        //set node and edge styles\n        //set overridable=true for styling individual\n        //nodes or edges\n        Node: {\n            height: 30,\n            width: 40,\n            type: 'ellipse',\n            color: '#aaa',\n            overridable: true\n        },\n        \n        Edge: {\n            type: 'bezier',\n            overridable: true\n        },\n        \n        onBeforeCompute: function(node){\n            Log.write("+'"'+"loading "+'"'+" + node.name);\n        },\n        \n        onAfterCompute: function(){\n            Log.write("+'"'+"done"+'"'+");\n        },\n        \n        //This method is called on DOM label creation.\n        //Use this method to add event handlers and styles to\n        //your node.\n        onCreateLabel: function(label, node){\n            label.id = node.id;            \n            label.innerHTML = node.name;\n            label.onclick = function(){\n            	if(normal.checked) {\n            	  st.onClick(node.id);\n            	} else {\n                st.setRoot(node.id, 'animate');\n            	}\n            };\n            //set label styles\n            var style = label.style;\n            style.width = 40 + 'px';\n            style.height = 17 + 'px';            \n            style.cursor = 'pointer';\n            style.color = '#333';\n            style.fontSize = '0.8em';\n            style.textAlign= 'center';\n            style.paddingTop = '8px';\n        },\n        \n        //This method is called right before plotting\n        //a node. It's useful for changing an individual node\n        //style properties before plotting it.\n        //The data properties prefixed with a dollar\n        //sign will override the global node style properties.\n        onBeforePlotNode: function(node){\n            //add some color to the nodes in the path between the\n            //root node and the selected node.\n            if (node.selected) {\n                node.data.$color = "+'"'+"#ff7"+'"'+";\n            }\n            else {\n                delete node.data.$color;\n                //if the node belongs to the last plotted level\n                if(!node.anySubnode("+'"'+"exist"+'"'+")) {\n                    //count children number\n                    var count = 0;\n                    node.eachSubnode(function(n) { count++; });\n                    //assign a node color based on\n                    //how many children it has\n                    node.data.$color = ['#aaa', '#abb', '#acc', '#add', '#aee', '#aff'][count];                    \n                }\n            }\n        },\n        \n        //This method is called right before plotting\n        //an edge. It's useful for changing an individual edge\n        //style properties before plotting it.\n        //Edge data proprties prefixed with a dollar sign will\n        //override the Edge global style properties.\n        onBeforePlotLine: function(adj){\n            if (adj.nodeFrom.selected && adj.nodeTo.selected) {\n                adj.data.$color = "+'"'+"#eed"+'"'+";\n                adj.data.$lineWidth = 3;\n            }\n            else {\n                delete adj.data.$color;\n                delete adj.data.$lineWidth;\n            }\n        }\n    });\n    //load json data\n    st.loadJSON(json);\n\n    //compute node positions and layout\n    st.compute();\n    //optional: make a translation of the tree\n    st.geom.translate(new $jit.Complex(-200, 0), "+'"'+"current"+'"'+");\n    //emulate a click on the root node.\n    st.onClick(st.root);\n    //end\n    \n    //Add event handlers to switch spacetree orientation.\n    var top = $jit.id('r-top'), \n        left = $jit.id('r-left'), \n        bottom = $jit.id('r-bottom'), \n        right = $jit.id('r-right'),\n        normal = $jit.id('s-normal');\n        \n    \n    function changeHandler() {\n        if(this.checked) {\n             bottom.disabled = right.disabled = left.disabled = top.disabled = true;\n            st.switchPosition(this.value, "+'"'+"animate"+'"'+", {\n                onComplete: function(){\n                    bottom.disabled = right.disabled = left.disabled = top.disabled = false;\n                }\n            });\n        }\n    };\n    \n    top.onchange = left.onchange = bottom.onchange = right.onchange = changeHandler;\n    //end\n\n}\n";
            	//"{ 		        id: "+"'"+"node02"+"'"+", 		        name: "+"'"+"0.2"+"'"+", 		        data: {}, 		        children: [{ 		            id: "+"'"+"node13"+"'"+", 		            name: "+"'"+"1.3"+"'"+", 		            data: {}, 		            children: [{ 		                id: "+"'"+"node24"+"'"+", 		                name: "+"'"+"2.4"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node35"+"'"+", 		                    name: "+"'"+"3.5"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node46"+"'"+", 		                        name: "+"'"+"4.6"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node37"+"'"+", 		                    name: "+"'"+"3.7"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node48"+"'"+", 		                        name: "+"'"+"4.8"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node49"+"'"+", 		                        name: "+"'"+"4.9"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node410"+"'"+", 		                        name: "+"'"+"4.10"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node411"+"'"+", 		                        name: "+"'"+"4.11"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node312"+"'"+", 		                    name: "+"'"+"3.12"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node413"+"'"+", 		                        name: "+"'"+"4.13"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node314"+"'"+", 		                    name: "+"'"+"3.14"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node415"+"'"+", 		                        name: "+"'"+"4.15"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node416"+"'"+", 		                        name: "+"'"+"4.16"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node417"+"'"+", 		                        name: "+"'"+"4.17"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node418"+"'"+", 		                        name: "+"'"+"4.18"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node319"+"'"+", 		                    name: "+"'"+"3.19"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node420"+"'"+", 		                        name: "+"'"+"4.20"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node421"+"'"+", 		                        name: "+"'"+"4.21"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node222"+"'"+", 		                name: "+"'"+"2.22"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node323"+"'"+", 		                    name: "+"'"+"3.23"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node424"+"'"+", 		                        name: "+"'"+"4.24"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }] 		        }, { 		            id: "+"'"+"node125"+"'"+", 		            name: "+"'"+"1.25"+"'"+", 		            data: {}, 		            children: [{ 		                id: "+"'"+"node226"+"'"+", 		                name: "+"'"+"2.26"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node327"+"'"+", 		                    name: "+"'"+"3.27"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node428"+"'"+", 		                        name: "+"'"+"4.28"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node429"+"'"+", 		                        name: "+"'"+"4.29"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node330"+"'"+", 		                    name: "+"'"+"3.30"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node431"+"'"+", 		                        name: "+"'"+"4.31"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node332"+"'"+", 		                    name: "+"'"+"3.32"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node433"+"'"+", 		                        name: "+"'"+"4.33"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node434"+"'"+", 		                        name: "+"'"+"4.34"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node435"+"'"+", 		                        name: "+"'"+"4.35"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node436"+"'"+", 		                        name: "+"'"+"4.36"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node237"+"'"+", 		                name: "+"'"+"2.37"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node338"+"'"+", 		                    name: "+"'"+"3.38"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node439"+"'"+", 		                        name: "+"'"+"4.39"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node440"+"'"+", 		                        name: "+"'"+"4.40"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node441"+"'"+", 		                        name: "+"'"+"4.41"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node342"+"'"+", 		                    name: "+"'"+"3.42"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node443"+"'"+", 		                        name: "+"'"+"4.43"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node344"+"'"+", 		                    name: "+"'"+"3.44"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node445"+"'"+", 		                        name: "+"'"+"4.45"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node446"+"'"+", 		                        name: "+"'"+"4.46"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node447"+"'"+", 		                        name: "+"'"+"4.47"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node348"+"'"+", 		                    name: "+"'"+"3.48"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node449"+"'"+", 		                        name: "+"'"+"4.49"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node450"+"'"+", 		                        name: "+"'"+"4.50"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node451"+"'"+", 		                        name: "+"'"+"4.51"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node452"+"'"+", 		                        name: "+"'"+"4.52"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node453"+"'"+", 		                        name: "+"'"+"4.53"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node354"+"'"+", 		                    name: "+"'"+"3.54"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node455"+"'"+", 		                        name: "+"'"+"4.55"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node456"+"'"+", 		                        name: "+"'"+"4.56"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node457"+"'"+", 		                        name: "+"'"+"4.57"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node258"+"'"+", 		                name: "+"'"+"2.58"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node359"+"'"+", 		                    name: "+"'"+"3.59"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node460"+"'"+", 		                        name: "+"'"+"4.60"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node461"+"'"+", 		                        name: "+"'"+"4.61"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node462"+"'"+", 		                        name: "+"'"+"4.62"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node463"+"'"+", 		                        name: "+"'"+"4.63"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node464"+"'"+", 		                        name: "+"'"+"4.64"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }] 		        }, { 		            id: "+"'"+"node165"+"'"+", 		            name: "+"'"+"1.65"+"'"+", 		            data: {}, 		            children: [{ 		                id: "+"'"+"node266"+"'"+", 		                name: "+"'"+"2.66"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node367"+"'"+", 		                    name: "+"'"+"3.67"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node468"+"'"+", 		                        name: "+"'"+"4.68"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node469"+"'"+", 		                        name: "+"'"+"4.69"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node470"+"'"+", 		                        name: "+"'"+"4.70"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node471"+"'"+", 		                        name: "+"'"+"4.71"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node372"+"'"+", 		                    name: "+"'"+"3.72"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node473"+"'"+", 		                        name: "+"'"+"4.73"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node474"+"'"+", 		                        name: "+"'"+"4.74"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node475"+"'"+", 		                        name: "+"'"+"4.75"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node476"+"'"+", 		                        name: "+"'"+"4.76"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node377"+"'"+", 		                    name: "+"'"+"3.77"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node478"+"'"+", 		                        name: "+"'"+"4.78"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node479"+"'"+", 		                        name: "+"'"+"4.79"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node380"+"'"+", 		                    name: "+"'"+"3.80"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node481"+"'"+", 		                        name: "+"'"+"4.81"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node482"+"'"+", 		                        name: "+"'"+"4.82"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node283"+"'"+", 		                name: "+"'"+"2.83"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node384"+"'"+", 		                    name: "+"'"+"3.84"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node485"+"'"+", 		                        name: "+"'"+"4.85"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node386"+"'"+", 		                    name: "+"'"+"3.86"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node487"+"'"+", 		                        name: "+"'"+"4.87"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node488"+"'"+", 		                        name: "+"'"+"4.88"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node489"+"'"+", 		                        name: "+"'"+"4.89"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node490"+"'"+", 		                        name: "+"'"+"4.90"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node491"+"'"+", 		                        name: "+"'"+"4.91"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node392"+"'"+", 		                    name: "+"'"+"3.92"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node493"+"'"+", 		                        name: "+"'"+"4.93"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node494"+"'"+", 		                        name: "+"'"+"4.94"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node495"+"'"+", 		                        name: "+"'"+"4.95"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node496"+"'"+", 		                        name: "+"'"+"4.96"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node397"+"'"+", 		                    name: "+"'"+"3.97"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node498"+"'"+", 		                        name: "+"'"+"4.98"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node399"+"'"+", 		                    name: "+"'"+"3.99"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4100"+"'"+", 		                        name: "+"'"+"4.100"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4101"+"'"+", 		                        name: "+"'"+"4.101"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4102"+"'"+", 		                        name: "+"'"+"4.102"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4103"+"'"+", 		                        name: "+"'"+"4.103"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node2104"+"'"+", 		                name: "+"'"+"2.104"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node3105"+"'"+", 		                    name: "+"'"+"3.105"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4106"+"'"+", 		                        name: "+"'"+"4.106"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4107"+"'"+", 		                        name: "+"'"+"4.107"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4108"+"'"+", 		                        name: "+"'"+"4.108"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node2109"+"'"+", 		                name: "+"'"+"2.109"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node3110"+"'"+", 		                    name: "+"'"+"3.110"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4111"+"'"+", 		                        name: "+"'"+"4.111"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4112"+"'"+", 		                        name: "+"'"+"4.112"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node3113"+"'"+", 		                    name: "+"'"+"3.113"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4114"+"'"+", 		                        name: "+"'"+"4.114"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4115"+"'"+", 		                        name: "+"'"+"4.115"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4116"+"'"+", 		                        name: "+"'"+"4.116"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node3117"+"'"+", 		                    name: "+"'"+"3.117"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4118"+"'"+", 		                        name: "+"'"+"4.118"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4119"+"'"+", 		                        name: "+"'"+"4.119"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4120"+"'"+", 		                        name: "+"'"+"4.120"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4121"+"'"+", 		                        name: "+"'"+"4.121"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node3122"+"'"+", 		                    name: "+"'"+"3.122"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4123"+"'"+", 		                        name: "+"'"+"4.123"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4124"+"'"+", 		                        name: "+"'"+"4.124"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node2125"+"'"+", 		                name: "+"'"+"2.125"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node3126"+"'"+", 		                    name: "+"'"+"3.126"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4127"+"'"+", 		                        name: "+"'"+"4.127"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4128"+"'"+", 		                        name: "+"'"+"4.128"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4129"+"'"+", 		                        name: "+"'"+"4.129"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }] 		        }, { 		            id: "+"'"+"node1130"+"'"+", 		            name: "+"'"+"1.130"+"'"+", 		            data: {}, 		            children: [{ 		                id: "+"'"+"node2131"+"'"+", 		                name: "+"'"+"2.131"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node3132"+"'"+", 		                    name: "+"'"+"3.132"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4133"+"'"+", 		                        name: "+"'"+"4.133"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4134"+"'"+", 		                        name: "+"'"+"4.134"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4135"+"'"+", 		                        name: "+"'"+"4.135"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4136"+"'"+", 		                        name: "+"'"+"4.136"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4137"+"'"+", 		                        name: "+"'"+"4.137"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }, { 		                id: "+"'"+"node2138"+"'"+", 		                name: "+"'"+"2.138"+"'"+", 		                data: {}, 		                children: [{ 		                    id: "+"'"+"node3139"+"'"+", 		                    name: "+"'"+"3.139"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4140"+"'"+", 		                        name: "+"'"+"4.140"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4141"+"'"+", 		                        name: "+"'"+"4.141"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }, { 		                    id: "+"'"+"node3142"+"'"+", 		                    name: "+"'"+"3.142"+"'"+", 		                    data: {}, 		                    children: [{ 		                        id: "+"'"+"node4143"+"'"+", 		                        name: "+"'"+"4.143"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4144"+"'"+", 		                        name: "+"'"+"4.144"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4145"+"'"+", 		                        name: "+"'"+"4.145"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4146"+"'"+", 		                        name: "+"'"+"4.146"+"'"+", 		                        data: {}, 		                        children: [] 		                    }, { 		                        id: "+"'"+"node4147"+"'"+", 		                        name: "+"'"+"4.147"+"'"+", 		                        data: {}, 		                        children: [] 		                    }] 		                }] 		            }] 		        }] 		    }; 		     		";

// "{        id: "+'"'+"node02"+'"'+",        name: "+'"'+"0.2"+'"'+",        data: {},        children: []}";
        		fOut.write((begining).getBytes());
        		fOut.write((json).getBytes());
        		fOut.write((end).getBytes());
        		fOut.flush();
        		fOut.close();
        	} catch (IOException e) {
        		// TODO Auto-generated catch block
        		Toast.makeText(ViewDraftTreeActivity.this, "The SDCARD isn't writeable. Is the device being used as a disk drive on a comptuer?\n "+e.toString(), Toast.LENGTH_LONG).show();

        	}

        	//"{         id: 'node02',         name: '0.2',         data: {},         children: [{             id: 'node13',             name: '1.3',             data: {},             children: [{                 id: 'node24',                 name: '2.4',                 data: {},                 children: [{                     id: 'node35',                     name: '3.5',                     data: {},                     children: [{                         id: 'node46',                         name: '4.6',                         data: {},                         children: []                     }]                 }, {                     id: 'node37',                     name: '3.7',                     data: {},                     children: [{                         id: 'node48',                         name: '4.8',                         data: {},                         children: []                     }, {                         id: 'node49',                         name: '4.9',                         data: {},                         children: []                     }, {                         id: 'node410',                         name: '4.10',                         data: {},                         children: []                     }, {                         id: 'node411',                         name: '4.11',                         data: {},                         children: []                     }]                 }, {                     id: 'node312',                     name: '3.12',                     data: {},                     children: [{                         id: 'node413',                         name: '4.13',                         data: {},                         children: []                     }]                 }, {                     id: 'node314',                     name: '3.14',                     data: {},                     children: [{                         id: 'node415',                         name: '4.15',                         data: {},                         children: []                     }, {                         id: 'node416',                         name: '4.16',                         data: {},                         children: []                     }, {                         id: 'node417',                         name: '4.17',                         data: {},                         children: []                     }, {                         id: 'node418',                         name: '4.18',                         data: {},                         children: []                     }]                 }, {                     id: 'node319',                     name: '3.19',                     data: {},                     children: [{                         id: 'node420',                         name: '4.20',                         data: {},                         children: []                     }, {                         id: 'node421',                         name: '4.21',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node222',                 name: '2.22',                 data: {},                 children: [{                     id: 'node323',                     name: '3.23',                     data: {},                     children: [{                         id: 'node424',                         name: '4.24',                         data: {},                         children: []                     }]                 }]             }]         }, {             id: 'node125',             name: '1.25',             data: {},             children: [{                 id: 'node226',                 name: '2.26',                 data: {},                 children: [{                     id: 'node327',                     name: '3.27',                     data: {},                     children: [{                         id: 'node428',                         name: '4.28',                         data: {},                         children: []                     }, {                         id: 'node429',                         name: '4.29',                         data: {},                         children: []                     }]                 }, {                     id: 'node330',                     name: '3.30',                     data: {},                     children: [{                         id: 'node431',                         name: '4.31',                         data: {},                         children: []                     }]                 }, {                     id: 'node332',                     name: '3.32',                     data: {},                     children: [{                         id: 'node433',                         name: '4.33',                         data: {},                         children: []                     }, {                         id: 'node434',                         name: '4.34',                         data: {},                         children: []                     }, {                         id: 'node435',                         name: '4.35',                         data: {},                         children: []                     }, {                         id: 'node436',                         name: '4.36',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node237',                 name: '2.37',                 data: {},                 children: [{                     id: 'node338',                     name: '3.38',                     data: {},                     children: [{                         id: 'node439',                         name: '4.39',                         data: {},                         children: []                     }, {                         id: 'node440',                         name: '4.40',                         data: {},                         children: []                     }, {                         id: 'node441',                         name: '4.41',                         data: {},                         children: []                     }]                 }, {                     id: 'node342',                     name: '3.42',                     data: {},                     children: [{                         id: 'node443',                         name: '4.43',                         data: {},                         children: []                     }]                 }, {                     id: 'node344',                     name: '3.44',                     data: {},                     children: [{                         id: 'node445',                         name: '4.45',                         data: {},                         children: []                     }, {                         id: 'node446',                         name: '4.46',                         data: {},                         children: []                     }, {                         id: 'node447',                         name: '4.47',                         data: {},                         children: []                     }]                 }, {                     id: 'node348',                     name: '3.48',                     data: {},                     children: [{                         id: 'node449',                         name: '4.49',                         data: {},                         children: []                     }, {                         id: 'node450',                         name: '4.50',                         data: {},                         children: []                     }, {                         id: 'node451',                         name: '4.51',                         data: {},                         children: []                     }, {                         id: 'node452',                         name: '4.52',                         data: {},                         children: []                     }, {                         id: 'node453',                         name: '4.53',                         data: {},                         children: []                     }]                 }, {                     id: 'node354',                     name: '3.54',                     data: {},                     children: [{                         id: 'node455',                         name: '4.55',                         data: {},                         children: []                     }, {                         id: 'node456',                         name: '4.56',                         data: {},                         children: []                     }, {                         id: 'node457',                         name: '4.57',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node258',                 name: '2.58',                 data: {},                 children: [{                     id: 'node359',                     name: '3.59',                     data: {},                     children: [{                         id: 'node460',                         name: '4.60',                         data: {},                         children: []                     }, {                         id: 'node461',                         name: '4.61',                         data: {},                         children: []                     }, {                         id: 'node462',                         name: '4.62',                         data: {},                         children: []                     }, {                         id: 'node463',                         name: '4.63',                         data: {},                         children: []                     }, {                         id: 'node464',                         name: '4.64',                         data: {},                         children: []                     }]                 }]             }]         }, {             id: 'node165',             name: '1.65',             data: {},             children: [{                 id: 'node266',                 name: '2.66',                 data: {},                 children: [{                     id: 'node367',                     name: '3.67',                     data: {},                     children: [{                         id: 'node468',                         name: '4.68',                         data: {},                         children: []                     }, {                         id: 'node469',                         name: '4.69',                         data: {},                         children: []                     }, {                         id: 'node470',                         name: '4.70',                         data: {},                         children: []                     }, {                         id: 'node471',                         name: '4.71',                         data: {},                         children: []                     }]                 }, {                     id: 'node372',                     name: '3.72',                     data: {},                     children: [{                         id: 'node473',                         name: '4.73',                         data: {},                         children: []                     }, {                         id: 'node474',                         name: '4.74',                         data: {},                         children: []                     }, {                         id: 'node475',                         name: '4.75',                         data: {},                         children: []                     }, {                         id: 'node476',                         name: '4.76',                         data: {},                         children: []                     }]                 }, {                     id: 'node377',                     name: '3.77',                     data: {},                     children: [{                         id: 'node478',                         name: '4.78',                         data: {},                         children: []                     }, {                         id: 'node479',                         name: '4.79',                         data: {},                         children: []                     }]                 }, {                     id: 'node380',                     name: '3.80',                     data: {},                     children: [{                         id: 'node481',                         name: '4.81',                         data: {},                         children: []                     }, {                         id: 'node482',                         name: '4.82',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node283',                 name: '2.83',                 data: {},                 children: [{                     id: 'node384',                     name: '3.84',                     data: {},                     children: [{                         id: 'node485',                         name: '4.85',                         data: {},                         children: []                     }]                 }, {                     id: 'node386',                     name: '3.86',                     data: {},                     children: [{                         id: 'node487',                         name: '4.87',                         data: {},                         children: []                     }, {                         id: 'node488',                         name: '4.88',                         data: {},                         children: []                     }, {                         id: 'node489',                         name: '4.89',                         data: {},                         children: []                     }, {                         id: 'node490',                         name: '4.90',                         data: {},                         children: []                     }, {                         id: 'node491',                         name: '4.91',                         data: {},                         children: []                     }]                 }, {                     id: 'node392',                     name: '3.92',                     data: {},                     children: [{                         id: 'node493',                         name: '4.93',                         data: {},                         children: []                     }, {                         id: 'node494',                         name: '4.94',                         data: {},                         children: []                     }, {                         id: 'node495',                         name: '4.95',                         data: {},                         children: []                     }, {                         id: 'node496',                         name: '4.96',                         data: {},                         children: []                     }]                 }, {                     id: 'node397',                     name: '3.97',                     data: {},                     children: [{                         id: 'node498',                         name: '4.98',                         data: {},                         children: []                     }]                 }, {                     id: 'node399',                     name: '3.99',                     data: {},                     children: [{                         id: 'node4100',                         name: '4.100',                         data: {},                         children: []                     }, {                         id: 'node4101',                         name: '4.101',                         data: {},                         children: []                     }, {                         id: 'node4102',                         name: '4.102',                         data: {},                         children: []                     }, {                         id: 'node4103',                         name: '4.103',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node2104',                 name: '2.104',                 data: {},                 children: [{                     id: 'node3105',                     name: '3.105',                     data: {},                     children: [{                         id: 'node4106',                         name: '4.106',                         data: {},                         children: []                     }, {                         id: 'node4107',                         name: '4.107',                         data: {},                         children: []                     }, {                         id: 'node4108',                         name: '4.108',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node2109',                 name: '2.109',                 data: {},                 children: [{                     id: 'node3110',                     name: '3.110',                     data: {},                     children: [{                         id: 'node4111',                         name: '4.111',                         data: {},                         children: []                     }, {                         id: 'node4112',                         name: '4.112',                         data: {},                         children: []                     }]                 }, {                     id: 'node3113',                     name: '3.113',                     data: {},                     children: [{                         id: 'node4114',                         name: '4.114',                         data: {},                         children: []                     }, {                         id: 'node4115',                         name: '4.115',                         data: {},                         children: []                     }, {                         id: 'node4116',                         name: '4.116',                         data: {},                         children: []                     }]                 }, {                     id: 'node3117',                     name: '3.117',                     data: {},                     children: [{                         id: 'node4118',                         name: '4.118',                         data: {},                         children: []                     }, {                         id: 'node4119',                         name: '4.119',                         data: {},                         children: []                     }, {                         id: 'node4120',                         name: '4.120',                         data: {},                         children: []                     }, {                         id: 'node4121',                         name: '4.121',                         data: {},                         children: []                     }]                 }, {                     id: 'node3122',                     name: '3.122',                     data: {},                     children: [{                         id: 'node4123',                         name: '4.123',                         data: {},                         children: []                     }, {                         id: 'node4124',                         name: '4.124',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node2125',                 name: '2.125',                 data: {},                 children: [{                     id: 'node3126',                     name: '3.126',                     data: {},                     children: [{                         id: 'node4127',                         name: '4.127',                         data: {},                         children: []                     }, {                         id: 'node4128',                         name: '4.128',                         data: {},                         children: []                     }, {                         id: 'node4129',                         name: '4.129',                         data: {},                         children: []                     }]                 }]             }]         }, {             id: 'node1130',             name: '1.130',             data: {},             children: [{                 id: 'node2131',                 name: '2.131',                 data: {},                 children: [{                     id: 'node3132',                     name: '3.132',                     data: {},                     children: [{                         id: 'node4133',                         name: '4.133',                         data: {},                         children: []                     }, {                         id: 'node4134',                         name: '4.134',                         data: {},                         children: []                     }, {                         id: 'node4135',                         name: '4.135',                         data: {},                         children: []                     }, {                         id: 'node4136',                         name: '4.136',                         data: {},                         children: []                     }, {                         id: 'node4137',                         name: '4.137',                         data: {},                         children: []                     }]                 }]             }, {                 id: 'node2138',                 name: '2.138',                 data: {},                 children: [{                     id: 'node3139',                     name: '3.139',                     data: {},                     children: [{                         id: 'node4140',                         name: '4.140',                         data: {},                         children: []                     }, {                         id: 'node4141',                         name: '4.141',                         data: {},                         children: []                     }]                 }, {                     id: 'node3142',                     name: '3.142',                     data: {},                     children: [{                         id: 'node4143',                         name: '4.143',                         data: {},                         children: []                     }, {                         id: 'node4144',                         name: '4.144',                         data: {},                         children: []                     }, {                         id: 'node4145',                         name: '4.145',                         data: {},                         children: []                     }, {                         id: 'node4146',                         name: '4.146',                         data: {},                         children: []                     }, {                         id: 'node4147',                         name: '4.147',                         data: {},                         children: []                     }]                 }]             }]         }]     };      }";
        	return path+mResultsFile;
        }
        
        public String generateData(){
        	int maxDepth= 4;
        	int currentDepth=0;
        	String id = "0";
        	String data="json = ";
        	
        	
        	data = data+"{id: \""+ "0"
			+"\",\nname: \""+"root"
			+"\",\ndata: {"
        	+"},\nchildren: [";
        	
        	
        	data= data + getSubtree(id);
        	
        	
			//end entire json 
        	data = data+";";
        	String json ="json = {\n        id: "+'"'+"node02"+'"'+",\n        name: "+'"'+"0.2"+'"'+",\n        data: {},\n        children: [{\n            id: "+'"'+"node13"+'"'+",\n            name: "+'"'+"1.3"+'"'+",\n            data: {},\n            children: [{\n                id: "+'"'+"node24"+'"'+",\n                name: "+'"'+"2.4"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node35"+'"'+",\n                    name: "+'"'+"3.5"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node46"+'"'+",\n                        name: "+'"'+"4.6"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node37"+'"'+",\n                    name: "+'"'+"3.7"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node48"+'"'+",\n                        name: "+'"'+"4.8"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node49"+'"'+",\n                        name: "+'"'+"4.9"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node410"+'"'+",\n                        name: "+'"'+"4.10"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node411"+'"'+",\n                        name: "+'"'+"4.11"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node312"+'"'+",\n                    name: "+'"'+"3.12"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node413"+'"'+",\n                        name: "+'"'+"4.13"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node314"+'"'+",\n                    name: "+'"'+"3.14"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node415"+'"'+",\n                        name: "+'"'+"4.15"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node416"+'"'+",\n                        name: "+'"'+"4.16"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node417"+'"'+",\n                        name: "+'"'+"4.17"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node418"+'"'+",\n                        name: "+'"'+"4.18"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node319"+'"'+",\n                    name: "+'"'+"3.19"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node420"+'"'+",\n                        name: "+'"'+"4.20"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node421"+'"'+",\n                        name: "+'"'+"4.21"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node222"+'"'+",\n                name: "+'"'+"2.22"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node323"+'"'+",\n                    name: "+'"'+"3.23"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node424"+'"'+",\n                        name: "+'"'+"4.24"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }]\n        }, {\n            id: "+'"'+"node125"+'"'+",\n            name: "+'"'+"1.25"+'"'+",\n            data: {},\n            children: [{\n                id: "+'"'+"node226"+'"'+",\n                name: "+'"'+"2.26"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node327"+'"'+",\n                    name: "+'"'+"3.27"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node428"+'"'+",\n                        name: "+'"'+"4.28"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node429"+'"'+",\n                        name: "+'"'+"4.29"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node330"+'"'+",\n                    name: "+'"'+"3.30"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node431"+'"'+",\n                        name: "+'"'+"4.31"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node332"+'"'+",\n                    name: "+'"'+"3.32"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node433"+'"'+",\n                        name: "+'"'+"4.33"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node434"+'"'+",\n                        name: "+'"'+"4.34"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node435"+'"'+",\n                        name: "+'"'+"4.35"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node436"+'"'+",\n                        name: "+'"'+"4.36"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node237"+'"'+",\n                name: "+'"'+"2.37"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node338"+'"'+",\n                    name: "+'"'+"3.38"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node439"+'"'+",\n                        name: "+'"'+"4.39"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node440"+'"'+",\n                        name: "+'"'+"4.40"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node441"+'"'+",\n                        name: "+'"'+"4.41"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node342"+'"'+",\n                    name: "+'"'+"3.42"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node443"+'"'+",\n                        name: "+'"'+"4.43"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node344"+'"'+",\n                    name: "+'"'+"3.44"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node445"+'"'+",\n                        name: "+'"'+"4.45"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node446"+'"'+",\n                        name: "+'"'+"4.46"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node447"+'"'+",\n                        name: "+'"'+"4.47"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node348"+'"'+",\n                    name: "+'"'+"3.48"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node449"+'"'+",\n                        name: "+'"'+"4.49"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node450"+'"'+",\n                        name: "+'"'+"4.50"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node451"+'"'+",\n                        name: "+'"'+"4.51"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node452"+'"'+",\n                        name: "+'"'+"4.52"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node453"+'"'+",\n                        name: "+'"'+"4.53"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node354"+'"'+",\n                    name: "+'"'+"3.54"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node455"+'"'+",\n                        name: "+'"'+"4.55"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node456"+'"'+",\n                        name: "+'"'+"4.56"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node457"+'"'+",\n                        name: "+'"'+"4.57"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node258"+'"'+",\n                name: "+'"'+"2.58"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node359"+'"'+",\n                    name: "+'"'+"3.59"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node460"+'"'+",\n                        name: "+'"'+"4.60"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node461"+'"'+",\n                        name: "+'"'+"4.61"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node462"+'"'+",\n                        name: "+'"'+"4.62"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node463"+'"'+",\n                        name: "+'"'+"4.63"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node464"+'"'+",\n                        name: "+'"'+"4.64"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }]\n        }, {\n            id: "+'"'+"node165"+'"'+",\n            name: "+'"'+"1.65"+'"'+",\n            data: {},\n            children: [{\n                id: "+'"'+"node266"+'"'+",\n                name: "+'"'+"2.66"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node367"+'"'+",\n                    name: "+'"'+"3.67"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node468"+'"'+",\n                        name: "+'"'+"4.68"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node469"+'"'+",\n                        name: "+'"'+"4.69"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node470"+'"'+",\n                        name: "+'"'+"4.70"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node471"+'"'+",\n                        name: "+'"'+"4.71"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node372"+'"'+",\n                    name: "+'"'+"3.72"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node473"+'"'+",\n                        name: "+'"'+"4.73"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node474"+'"'+",\n                        name: "+'"'+"4.74"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node475"+'"'+",\n                        name: "+'"'+"4.75"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node476"+'"'+",\n                        name: "+'"'+"4.76"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node377"+'"'+",\n                    name: "+'"'+"3.77"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node478"+'"'+",\n                        name: "+'"'+"4.78"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node479"+'"'+",\n                        name: "+'"'+"4.79"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node380"+'"'+",\n                    name: "+'"'+"3.80"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node481"+'"'+",\n                        name: "+'"'+"4.81"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node482"+'"'+",\n                        name: "+'"'+"4.82"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node283"+'"'+",\n                name: "+'"'+"2.83"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node384"+'"'+",\n                    name: "+'"'+"3.84"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node485"+'"'+",\n                        name: "+'"'+"4.85"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node386"+'"'+",\n                    name: "+'"'+"3.86"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node487"+'"'+",\n                        name: "+'"'+"4.87"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node488"+'"'+",\n                        name: "+'"'+"4.88"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node489"+'"'+",\n                        name: "+'"'+"4.89"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node490"+'"'+",\n                        name: "+'"'+"4.90"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node491"+'"'+",\n                        name: "+'"'+"4.91"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node392"+'"'+",\n                    name: "+'"'+"3.92"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node493"+'"'+",\n                        name: "+'"'+"4.93"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node494"+'"'+",\n                        name: "+'"'+"4.94"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node495"+'"'+",\n                        name: "+'"'+"4.95"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node496"+'"'+",\n                        name: "+'"'+"4.96"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node397"+'"'+",\n                    name: "+'"'+"3.97"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node498"+'"'+",\n                        name: "+'"'+"4.98"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node399"+'"'+",\n                    name: "+'"'+"3.99"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4100"+'"'+",\n                        name: "+'"'+"4.100"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4101"+'"'+",\n                        name: "+'"'+"4.101"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4102"+'"'+",\n                        name: "+'"'+"4.102"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4103"+'"'+",\n                        name: "+'"'+"4.103"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node2104"+'"'+",\n                name: "+'"'+"2.104"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node3105"+'"'+",\n                    name: "+'"'+"3.105"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4106"+'"'+",\n                        name: "+'"'+"4.106"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4107"+'"'+",\n                        name: "+'"'+"4.107"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4108"+'"'+",\n                        name: "+'"'+"4.108"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node2109"+'"'+",\n                name: "+'"'+"2.109"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node3110"+'"'+",\n                    name: "+'"'+"3.110"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4111"+'"'+",\n                        name: "+'"'+"4.111"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4112"+'"'+",\n                        name: "+'"'+"4.112"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node3113"+'"'+",\n                    name: "+'"'+"3.113"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4114"+'"'+",\n                        name: "+'"'+"4.114"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4115"+'"'+",\n                        name: "+'"'+"4.115"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4116"+'"'+",\n                        name: "+'"'+"4.116"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node3117"+'"'+",\n                    name: "+'"'+"3.117"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4118"+'"'+",\n                        name: "+'"'+"4.118"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4119"+'"'+",\n                        name: "+'"'+"4.119"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4120"+'"'+",\n                        name: "+'"'+"4.120"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4121"+'"'+",\n                        name: "+'"'+"4.121"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node3122"+'"'+",\n                    name: "+'"'+"3.122"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4123"+'"'+",\n                        name: "+'"'+"4.123"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4124"+'"'+",\n                        name: "+'"'+"4.124"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node2125"+'"'+",\n                name: "+'"'+"2.125"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node3126"+'"'+",\n                    name: "+'"'+"3.126"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4127"+'"'+",\n                        name: "+'"'+"4.127"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4128"+'"'+",\n                        name: "+'"'+"4.128"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4129"+'"'+",\n                        name: "+'"'+"4.129"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }]\n        }, {\n            id: "+'"'+"node1130"+'"'+",\n            name: "+'"'+"1.130"+'"'+",\n            data: {},\n            children: [{\n                id: "+'"'+"node2131"+'"'+",\n                name: "+'"'+"2.131"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node3132"+'"'+",\n                    name: "+'"'+"3.132"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4133"+'"'+",\n                        name: "+'"'+"4.133"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4134"+'"'+",\n                        name: "+'"'+"4.134"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4135"+'"'+",\n                        name: "+'"'+"4.135"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4136"+'"'+",\n                        name: "+'"'+"4.136"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4137"+'"'+",\n                        name: "+'"'+"4.137"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }, {\n                id: "+'"'+"node2138"+'"'+",\n                name: "+'"'+"2.138"+'"'+",\n                data: {},\n                children: [{\n                    id: "+'"'+"node3139"+'"'+",\n                    name: "+'"'+"3.139"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4140"+'"'+",\n                        name: "+'"'+"4.140"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4141"+'"'+",\n                        name: "+'"'+"4.141"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }, {\n                    id: "+'"'+"node3142"+'"'+",\n                    name: "+'"'+"3.142"+'"'+",\n                    data: {},\n                    children: [{\n                        id: "+'"'+"node4143"+'"'+",\n                        name: "+'"'+"4.143"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4144"+'"'+",\n                        name: "+'"'+"4.144"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4145"+'"'+",\n                        name: "+'"'+"4.145"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4146"+'"'+",\n                        name: "+'"'+"4.146"+'"'+",\n                        data: {},\n                        children: []\n                    }, {\n                        id: "+'"'+"node4147"+'"'+",\n                        name: "+'"'+"4.147"+'"'+",\n                        data: {},\n                        children: []\n                    }]\n                }]\n            }]\n        }]\n    };";
        	Toast.makeText(ViewDraftTreeActivity.this, "The data is "+data, Toast.LENGTH_LONG).show();
        	
        	return data;
        }
        public String getSubtree(String id){
        	String[] PROJECTION = new String[] {
            		AuBlogHistory._ID, //0
            		AuBlogHistory.ENTRY_TITLE, 
            		AuBlogHistory.ENTRY_CONTENT, //2
            		AuBlogHistory.ENTRY_LABELS,
            		AuBlogHistory.PUBLISHED, //4
            		AuBlogHistory.DAUGHTER_ENTRY,
            		AuBlogHistory.PARENT_ENTRY //6
            	};
        	String node ="";
        	Boolean firstChild = true;
        	try {
        
        		/*
        		 * find all nodes with this node as its parent
        		 */
	        	Cursor cursor =managedQuery(AuBlogHistory.CONTENT_URI, PROJECTION, AuBlogHistory.PARENT_ENTRY +"="+id, null, null);
	        	Toast.makeText(ViewDraftTreeActivity.this, "There are \n"+cursor.getCount()+" daughters", Toast.LENGTH_LONG).show();
	        	if ((cursor != null) ) {
	    			// Requery in case something changed while paused (such as the title)
	    			cursor.requery();
	                // Make sure we are at the one and only row in the cursor.
	                cursor.moveToFirst();
	                while (cursor.isAfterLast() == false){
	                	if(!firstChild){
	                		node= node+",";
	                	}
	                	id=cursor.getString(0);
	                	node = node+"{\nid: \""+ id
	                	+"\",\nname: \""+id
	                	+"\",\ndata: {"
	                	+"},\nchildren: [";
	                	
	                	/*
	                	 * find all nodes with this node as its parent
	                	 */
	                	node = getSubtree(id);

	                	node =node+ "]\n} ";
	                	firstChild=false;
	                	cursor.moveToNext();
	                }
	                //firstChild=true;
	        	}
        	} catch (IllegalArgumentException e) {
				// Log.e(TAG, "IllegalArgumentException (DataBase failed)");
				Toast.makeText(ViewDraftTreeActivity.this, "Retrieval from DB failed with an illegal argument exception "+e, Toast.LENGTH_LONG).show();
			} catch (Exception e) {
				// Log.e(TAG, "Exception (DataBase failed)");
				Toast.makeText(ViewDraftTreeActivity.this, "The cursor returned is "+e, Toast.LENGTH_LONG).show();
			}

			//end root node
			node = node+ "]\n} ";
        	return node;
        }
     
        
        
    }
    @Override
    public void onSaveInstanceState(Bundle savedInstanceState) {
      // Save UI state changes to the savedInstanceState.
      // This bundle will be passed to onCreate if the process is
      // killed and restarted.
      super.onSaveInstanceState(savedInstanceState);
    }
    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState) {
      super.onRestoreInstanceState(savedInstanceState);
      // Restore UI state from the savedInstanceState.
      // This bundle has also been passed to onCreate.

    }
    @Override
	protected void onPause() {
		super.onPause();
	}
	@Override
	protected void onDestroy() {
		super.onDestroy();

	}

    /**
     * Provides a hook for calling "alert" from javascript. Useful for
     * debugging your javascript.
     */
    final class MyWebChromeClient extends WebChromeClient {
        @Override
        public boolean onJsAlert(WebView view, String url, String message, JsResult result) {
            Log.d(TAG, message);
            result.confirm();
            return true;
        }
    }
}